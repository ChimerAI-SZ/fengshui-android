# 连线显示问题 - 快速检查清单

## ⚡ 5分钟快速诊断

### 第1步：确认案例存在
```
1. 启动应用
2. 查看右上角是否显示 "📋 案例: 案例名称"
   ✅ 显示 → 案例存在
   ❌ 显示 "📋 案例: 无" → 没有案例，需要在堪舆管理中创建
```

### 第2步：确认是否添加了原点和终点
```
1. 点击"📍 原点"按钮
   ✅ 显示原点列表 → 已有原点
   ❌ 弹出"暂无原点" → 需要添加原点
   
2. 无法判断是否有终点？
   → 点击"➕终点"添加一个终点
```

### 第3步：添加原点和终点
```
1. 确保已有案例和原点
2. 按顺序操作：
   a) 点击"➕终点" 添加终点 (最少1个)
   b) 点击"➕原点" 添加原点
   
3. 检查结果：
   ✅ 地图上出现蓝色连线 → 成功！
   ❌ 没有连线 → 继续步骤4
```

### 第4步：打开logcat查看日志
```
在Android Studio中：
1. View → Tool Windows → Logcat
2. 顶部搜索框输入：MapScreen
3. 查看最后出现的几条日志

关键日志检查：
✅ "Origins: 1, Destinations: 1" → 数据正确
✅ "Adding polyline from" → 连线被添加
❌ "GoogleMap not ready" → 地图未就绪
❌ "Error adding" → 出现错误
```

## 🔧 常见问题快速解决

### 问题A：添加原点后没有连线

**原因可能：**没有终点

**解决方案：**
```
1. 点击"➕终点"添加至少1个终点
2. 再点击"➕原点"添加原点
3. 现在应该能看到连线
```

### 问题B：看不到"📋 案例"按钮或显示"无"

**原因可能：**没有案例

**解决方案：**
```
在堪舆管理界面创建案例：
1. 点击底部菜单"堪舆管理"
2. 点击右上角"+"创建新案例
3. 输入案例名称，点击"创建"
4. 返回地图界面，应该能看到新案例
```

### 问题C：地图本身不显示

**原因可能：**Google Maps初始化失败

**解决方案：**
```
1. 确保安装了Google Play Services
2. 确保手机有网络连接
3. 确保定位权限已授予
4. 重启应用
```

### 问题D：logcat显示"Error adding polyline"

**原因可能：**mapProvider类型错误或GoogleMap未就绪

**解决方案：**
```
1. 查看完整错误信息（展开logcat中的错误行）
2. 常见错误：
   - "GoogleMap not initialized" 
     → 等待GoogleMap加载完成后再操作
   - "ClassCastException"
     → 可能是mapProvider配置问题
```

## 📱 操作流程验证

按照以下步骤验证连线显示：

```
[1] 打开应用
    ↓
[2] 确认显示 "📋 案例: xxx"（xxx是案例名称）
    ↓
[3] 点击"➕终点"添加终点
    ↓
[4] 点击"➕原点"添加原点
    ↓
[5] 查看地图
    ✅ 看到蓝色连线 → 成功
    ❌ 没看到 → 查看logcat日志
```

## 🔍 logcat日志快速参考

| 日志内容 | 含义 | 状态 |
|--------|------|------|
| Loading project: xxx, found N points | 案例加载成功 | ✅ 正常 |
| Origins: X, Destinations: X | 原点终点数据正确 | ✅ 正常 |
| Total lines: X | 生成了X条连线 | ✅ 正常 |
| Adding polyline from ... to ... | 添加连线 | ✅ 正常 |
| GoogleMap not ready | 地图未初始化 | ❌ 等待 |
| Error adding origin point | 添加原点失败 | ❌ 检查日志 |
| Error adding polyline | 添加连线失败 | ❌ 检查日志 |

## 让我确认一下你的问题

如果按照以上步骤试过仍然不行，请告诉我：

1. **地图本身是否显示**（看到谷歌地图背景）
   - ✅ 是 
   - ❌ 否

2. **点击"➕原点"或"➕终点"是否有反应**（地图视角是否移动）
   - ✅ 有反应
   - ❌ 无反应
   - ⚠️ 有错误提示

3. **logcat中是否看到"MapScreen"开头的日志**
   - ✅ 看到
   - ❌ 没看到

4. **原点/终点是否成功创建**（点击"📍 原点"是否能看到列表）
   - ✅ 能看到
   - ❌ 看不到

基于这些答案，可以更精确地诊断问题。
